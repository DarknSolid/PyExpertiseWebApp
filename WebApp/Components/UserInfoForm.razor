@using System.ComponentModel.DataAnnotations
@using WebApp.Models;
<MudText Typo="Typo.h3" GutterBottom="true">Enter GitHub Username</MudText>
<MudDivider Light="true" />
<MudForm @bind-IsValid="@success">
    <MudCard >
        <MudCardHeader>
            <MudText>Please provide your GitHub username</MudText>
        </MudCardHeader>
        <MudCardContent>
            <MudTextField Label="GitHub Username"
                          Class="mt-3" 
                          @bind-Value="InfoModel.Username"
                          For="@(() => InfoModel.Username)"
                          Required="true"
                          RequiredError="Url required"
                          Validation="@(new MinLengthAttribute(2) {ErrorMessage = "min. 2 characters"})" />

            <MudCheckBox @bind-Checked="@InfoModel.IsItu" Label="My GitHub account belongs to github.itu.dk" Color="Color.Secondary"></MudCheckBox>
        </MudCardContent>
        <MudCardActions>
            <MudButton Disabled="@(!success)" Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto" OnClick="OnValidSubmit">Analyse</MudButton>
        </MudCardActions>
    </MudCard>
</MudForm>

@code {
    [Parameter]
    public Func<UserInfoModel, Task> OnSubmit { get; set; }

    private RepositoriesResultModel? _repositoriesResultModel;

    public UserInfoModel InfoModel { get; set; }

    bool success;

    public UserInfoForm()
    {
        InfoModel = new()
            {
                //Email = "davidism@gmail.com",
                //Urls = new List<string>() //{ "https://github.com/pallets/flask.git" },
            };
    }

    private async Task OnValidSubmit()
    {
        await OnSubmit(InfoModel);
    }
}