@using WebApp.Models;
<MudText Typo="Typo.h3" GutterBottom="true">Enter your GitHub Information</MudText>

<EditForm Model="@InfoModel" OnValidSubmit="OnValidSubmit">
    <DataAnnotationsValidator />
    <MudCard>
        <MudCardHeader>
            <MudText>Please provide your email to your GitHub account and the url to one of your python projects on GitHub. The url should be the git clone url, e.g. https://github.com/username/repository.git</MudText>
        </MudCardHeader>
    <MudCardContent>
        <MudText Typo="Typo.subtitle2">Note: we only support urls for github.com and github.itu.dk</MudText>
        <MudTextField Label="Email"
                      Class="mt-3" HelperText="The email of your GitHub account"
                      @bind-Value="InfoModel.Email"
                      For="@(() => InfoModel.Email)" />
        <MudTextField Label="GitHub Clone Url"
                          HelperText="Please enter a valid url to one of your largest python projects. e.g. https://github.com/username/repository.git"
                      
                      @bind-Value="InfoModel.Url"
                      For="@(() => InfoModel.Url)" />
    </MudCardContent>
    <MudCardActions>
        <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto">Analyse</MudButton>
    </MudCardActions>
    </MudCard>
</EditForm>

@code {
    [Parameter]
    public Func<InfoModel, Task> OnSubmit { get; set; }

    public InfoModel InfoModel { get; set; }

    public UserInfoForm()
    {
        InfoModel = new()
        {
                //Email = "mircea.lungu@gmail.com",
                //Url = "https://github.com/zeeguu/api.git"
        };
    }

    private async Task OnValidSubmit()
    {
        if (!InfoModel.Url.EndsWith(".git"))
        {
            InfoModel.Url += ".git";
        }
        await OnSubmit(InfoModel);
    }
}